// ... dentro de la parte que procesa cada hoja:

// Después de construir filteredHeaders y filteredRows, agrega:
console.log(`--- Datos para hoja ${hojaNombre} ---`);
console.log("Headers:", filteredHeaders);
console.log("Rows:", filteredRows);
filteredRows.forEach((r, i) => console.log(`Row ${i}: `, r));

// Luego intenta renderizar
try {
  new gridjs.Grid({
    columns,
    data: filteredRows,
    search: true,
    pagination: { enabled: true, limit: 10 },
    sort: true,
    resizable: true,
    language: {
      search: { placeholder: '🔍 Buscar...' },
      pagination: {
        previous: 'Anterior',
        next: 'Siguiente',
        showing: 'Mostrando',
        results: () => 'registros'
      }
    }
  }).render(contenedor);
  console.log(`✅ Renderizado exitoso para "${hojaNombre}"`);
} catch (err) {
  console.error(`❌ Error renderizando tabla para "${hojaNombre}":`, err);
  contenedor.innerHTML = `<div class="alert alert-danger">❌ Error mostrando tabla de "${hojaNombre}".</div>`;
}
